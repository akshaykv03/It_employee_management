{% extends 'developerHome.html' %}
{% block content %}

<head>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    /* --- Notification Card Style --- */
    .notification-card {
      background-color: #fff8e6;
      border-left: 5px solid #f39c12;
      border-radius: 10px;
      padding: 15px 20px;
      margin-bottom: 15px;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: 0.3s;
    }

    .notification-card:hover {
      transform: translateY(-3px);
      background-color: #fff4d6;
    }

    .notification-info {
      flex: 1;
      padding-left: 10px;
    }

    .notification-title {
      font-weight: 600;
      color: #333;
      font-size: 17px;
    }

    .notification-meta {
      font-size: 13px;
      color: #777;
      margin-top: 4px;
    }

    .notification-btns {
      display: flex;
      gap: 10px;
    }

    .notification-btns a,
    .notification-btns button {
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      font-size: 13px;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    .view-btn {
      background-color: #f39c12;
    }

    .view-btn:hover {
      background-color: #d68910;
    }

    .clear-btn {
      background-color: #28a745;
    }

    .clear-btn:hover {
      background-color: #1e7e34;
    }

    .notification-seen {
      background-color: #f1f1f1;
      opacity: 0.8;
    }

    /* Hero height */
    #hero.hero {
      min-height: 80vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding-top: 80px;
    }

    @media (max-width: 768px) {
      .notification-card {
        flex-direction: column;
        align-items: flex-start;
      }
      .notification-btns {
        margin-top: 10px;
      }
    }
  </style>
</head>

<section id="hero" class="hero section dark-background contact">
  <img src="../static/assets/img/hero-bg-user.jpg" alt="" data-aos="fade-in">

  <div class="container">
    <div class="col-lg-12">
      <div class="row gy-4 mt-5 justify-content-center" data-aos="fade-up">
        <div class="col-xl-4 col-md-6 text-center">
          <div class="icon-box">
            <i class="bi bi-bell"></i>
            <h3>Project Notifications</h3>
            <p>Latest updates on your assigned projects</p>
          </div>
        </div>
      </div>

      <div class="mt-4" id="notificationList">
        {% if data %}
          {% for project in data %}
            <a href="devProjects">
              <div class="notification-card">
              <i class="bi bi-briefcase-fill text-warning fs-3"></i>
              <div class="notification-info">
                <div class="notification-title">"{{ project.project.title }}" project assigned to you
                  <br>
                  {{ project.requirements }} 
                </div>
                <div class="notification-meta">
                  Client: {{ project.project.client_name }} |
                  Status: {{ project.project.status }} |
                  Assigned: {{ project.assigned_date }} |
                  Start Date: {{ project.start_date }} |
                  End Date: {{ project.end_date }}

                </div>
              </div>
              <div class="notification-btns">
                <a href="DevNotiClose?id={{ project.id }}" class="view-btn">Close</a>
              </div>
            </div>
            </a>
          {% endfor %}
        {% else %}
          <p class="text-center text-muted mt-4">No project notifications yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
</section>


{% if unseen %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    Swal.fire({
      title: 'ðŸ”” New Project Assigned!',
      text: 'You have {{ unseen|length }} new project{{ unseen|length|pluralize }}.',
      icon: 'info',
      showCancelButton: true,
      confirmButtonText: 'View Now',
      cancelButtonText: 'Mark as Seen',
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
    }).then((result) => {
      // Mark as seen when user clicks either button
      fetch('/clear_devnotifications/', {
  method: 'POST',
  headers: {
    'X-CSRFToken': '{{ csrf_token }}',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({ clear: true })
});

    });
  });
</script>



{% endif %}


{% endblock %}
